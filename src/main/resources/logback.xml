<?xml version="1.0" encoding="UTF-8"?>
<configuration>

	<property name="LOGS" value="./logs" />

	<appender name="STDOUT"
		class="ch.qos.logback.core.ConsoleAppender">
		<encoder>
			<pattern> %msg%n </pattern>
		</encoder>
	</appender>



	<appender name="RollingFile"
		class="ch.qos.logback.core.rolling.RollingFileAppender">
		<file>${LOGS}/splunk.log</file>

		<encoder
			class="ch.qos.logback.classic.encoder.PatternLayoutEncoder">
			<Pattern>%d %p %C{1.} [%t] %m%n</Pattern>
		</encoder>

		<!-- <encoder class="net.logstash.logback.encoder.LoggingEventCompositeJsonEncoder"> 
			<providers> <contextName> <fieldName>app</fieldName> </contextName> <timestamp> 
			<fieldName>ts</fieldName> <timeZone>UTC</timeZone> </timestamp> <loggerName> 
			<fieldName>logger</fieldName> </loggerName> <logLevel> <fieldName>level</fieldName> 
			</logLevel> <callerData> <classFieldName>class</classFieldName> <methodFieldName>method</methodFieldName> 
			<lineFieldName>line</lineFieldName> <fileFieldName>file</fileFieldName> </callerData> 
			<threadName> <fieldName>thread</fieldName> </threadName> <mdc /> <arguments> 
			<includeNonStructuredArguments>false </includeNonStructuredArguments> </arguments> 
			<stackTrace> <fieldName>stack</fieldName> </stackTrace> <message> <fieldName>msg</fieldName> 
			</message> </providers> </encoder> -->
			
			
		<rollingPolicy
			class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy">
			<!-- rollover daily and when the file reaches 10 MegaBytes -->
			<fileNamePattern>${LOGS}/archived/splunk-%d{yyyy-MM-dd}.%i.log
			</fileNamePattern>
			<timeBasedFileNamingAndTriggeringPolicy
				class="ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP">
				<maxFileSize>10MB</maxFileSize>
			</timeBasedFileNamingAndTriggeringPolicy>
		</rollingPolicy>
	</appender>


	<appender name="socket" class="com.splunk.logging.TcpAppender">
		<RemoteHost>127.0.0.1</RemoteHost>
		<Port>15000</Port>

		<layout class="ch.qos.logback.classic.PatternLayout">
			<pattern>%date{ISO8601} [%thread] %level: %msg%n</pattern>
		</layout>

		<!-- <encoder class="net.logstash.logback.encoder.LoggingEventCompositeJsonEncoder"> 
			<providers> <contextName> <fieldName>app</fieldName> </contextName> <timestamp> 
			<fieldName>ts</fieldName> <timeZone>UTC</timeZone> </timestamp> <loggerName> 
			<fieldName>logger</fieldName> </loggerName> <logLevel> <fieldName>level</fieldName> 
			</logLevel> <callerData> <classFieldName>class</classFieldName> <methodFieldName>method</methodFieldName> 
			<lineFieldName>line</lineFieldName> <fileFieldName>file</fileFieldName> </callerData> 
			<threadName> <fieldName>thread</fieldName> </threadName> <mdc /> <arguments> 
			<includeNonStructuredArguments>false </includeNonStructuredArguments> </arguments> 
			<stackTrace> <fieldName>stack</fieldName> </stackTrace> <message> <fieldName>msg</fieldName> 
			</message> </providers> </encoder> -->
	</appender>


	<!-- LOG everything at INFO level -->
	<root level="info,trace,warn">
		<appender-ref ref="STDOUT" />
	</root>

	<!-- LOG "splunk.logger*" at INFO level -->
	<logger name="splunk.logger" level="info" additivity="false">
		<appender-ref ref="RollingFile" />
	</logger>

	<logger name="splunk.logger" additivity="false" level="INFO">
		<appender-ref ref="socket" />
	</logger>


</configuration>